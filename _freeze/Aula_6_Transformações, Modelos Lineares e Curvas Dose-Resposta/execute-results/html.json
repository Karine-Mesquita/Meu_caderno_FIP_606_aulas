{
  "hash": "b703627cc84ec1c605ea18f5494b1908",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula_6_Transformações, Modelos Lineares e Curvas Dose-Resposta\"\nauthor: \"Karine Mesquita\"\nformat: html\neditor: visual\neditor_options: \n  chunk_output_type: inline\n---\n\n\n# Aula 6\n\nNesta aula abordamos estratégias para normalizar dados experimentais por meio de transformações (como a raiz quadrada e o método de **Box-Cox**), quando a Anova não atender aos pressupostos de normalidade e homocedasticidade. Por fim, introduzimos os **modelos não lineares** para curvas dose-resposta, utilizando o pacote `drc`.\n\n## Transformação de dados\n\n### Box cox\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"MASS\")\nlibrary(MASS)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'MASS' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\ninsects <- InsectSprays\n\nm1 <- lm(count ~spray, data = insects)\n\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'DHARMa' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThis is DHARMa 0.4.7. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#como não atendeu ao pressuposto de homogeneidade, testamos a transformação dos dados. \n#Inicialmente testa a transformação por raiz quadrada. \n\nm1 <- lm(sqrt(count) ~ spray, data = insects)\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sqrt(count) ~ spray, data = insects)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n     3.7607       0.1160      -2.5158      -1.5963      -1.9512       0.2579  \n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Transformação por log (com +1 para evitar log(0))\nm1_log <- lm(log(count + 1) ~ spray, data = insects)  # +1 para evitar log(0), caso tenha valores zero\nm1_log\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = log(count + 1) ~ spray, data = insects)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n     2.6967       0.0598      -1.7441      -0.9834      -1.2705       0.1189  \n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1_log))\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#raiz quadrada é 0.5 e log é 0.Quando lambda é 1 o valor é igual o original. \n#box cox é usado quando o log ou raiz não dá certo. \n#as médias tem que ser com os valores destransformados \n\nboxcox(lm(insects$count+0.1 ~ 1))\nb <- boxcox(lm(insects$count+0.1 ~ 1))\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda <- b$x[which.max(b$y)] # Extrair o lambda ótimo\nlambda\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4242424\n```\n\n\n:::\n\n```{.r .cell-code}\n# Quando for apresentar as médias, deve-se usar os valores originais (sem transformação).\n# A transformação é aplicada apenas para satisfazer os pressupostos da ANOVA ou regressão.\n\nlibrary(tidyverse) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'tidyverse' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'readr' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'stringr' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n✖ dplyr::select() masks MASS::select()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\ninsects <- insects |> \n  mutate(count2 = (count^lambda-1)/lambda) |> \n  mutate(count3 = (sqrt(count))) \nhist(insects$count2)\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n:::\n\n\n### Análise de regressão\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'gsheet' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=401662555#gid=401662555\")\nestande\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"exp\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"trat\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bloco\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"nplants\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"66\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"2\",\"4\":\"72\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"3\",\"4\":\"50\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"4\",\"4\":\"27\"},{\"1\":\"1\",\"2\":\"3\",\"3\":\"1\",\"4\":\"68\"},{\"1\":\"1\",\"2\":\"3\",\"3\":\"2\",\"4\":\"79\"},{\"1\":\"1\",\"2\":\"3\",\"3\":\"3\",\"4\":\"31\"},{\"1\":\"1\",\"2\":\"3\",\"3\":\"4\",\"4\":\"32\"},{\"1\":\"1\",\"2\":\"6\",\"3\":\"1\",\"4\":\"58\"},{\"1\":\"1\",\"2\":\"6\",\"3\":\"2\",\"4\":\"56\"},{\"1\":\"1\",\"2\":\"6\",\"3\":\"3\",\"4\":\"64\"},{\"1\":\"1\",\"2\":\"6\",\"3\":\"4\",\"4\":\"33\"},{\"1\":\"1\",\"2\":\"12\",\"3\":\"1\",\"4\":\"56\"},{\"1\":\"1\",\"2\":\"12\",\"3\":\"2\",\"4\":\"53\"},{\"1\":\"1\",\"2\":\"12\",\"3\":\"3\",\"4\":\"50\"},{\"1\":\"1\",\"2\":\"12\",\"3\":\"4\",\"4\":\"29\"},{\"1\":\"1\",\"2\":\"24\",\"3\":\"1\",\"4\":\"63\"},{\"1\":\"1\",\"2\":\"24\",\"3\":\"2\",\"4\":\"44\"},{\"1\":\"1\",\"2\":\"24\",\"3\":\"3\",\"4\":\"24\"},{\"1\":\"1\",\"2\":\"24\",\"3\":\"4\",\"4\":\"44\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"1\",\"4\":\"48\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"2\",\"4\":\"44\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"3\",\"4\":\"40\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"4\",\"4\":\"39\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"1\",\"4\":\"80\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"2\",\"4\":\"61\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"3\",\"4\":\"75\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"4\",\"4\":\"79\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"1\",\"4\":\"60\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"2\",\"4\":\"47\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"3\",\"4\":\"53\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"4\",\"4\":\"67\"},{\"1\":\"2\",\"2\":\"6\",\"3\":\"1\",\"4\":\"31\"},{\"1\":\"2\",\"2\":\"6\",\"3\":\"2\",\"4\":\"34\"},{\"1\":\"2\",\"2\":\"6\",\"3\":\"3\",\"4\":\"76\"},{\"1\":\"2\",\"2\":\"6\",\"3\":\"4\",\"4\":\"59\"},{\"1\":\"2\",\"2\":\"12\",\"3\":\"1\",\"4\":\"50\"},{\"1\":\"2\",\"2\":\"12\",\"3\":\"2\",\"4\":\"34\"},{\"1\":\"2\",\"2\":\"12\",\"3\":\"3\",\"4\":\"61\"},{\"1\":\"2\",\"2\":\"12\",\"3\":\"4\",\"4\":\"52\"},{\"1\":\"2\",\"2\":\"24\",\"3\":\"1\",\"4\":\"33\"},{\"1\":\"2\",\"2\":\"24\",\"3\":\"2\",\"4\":\"38\"},{\"1\":\"2\",\"2\":\"24\",\"3\":\"3\",\"4\":\"37\"},{\"1\":\"2\",\"2\":\"24\",\"3\":\"4\",\"4\":\"50\"},{\"1\":\"2\",\"2\":\"48\",\"3\":\"1\",\"4\":\"34\"},{\"1\":\"2\",\"2\":\"48\",\"3\":\"2\",\"4\":\"18\"},{\"1\":\"2\",\"2\":\"48\",\"3\":\"3\",\"4\":\"34\"},{\"1\":\"2\",\"2\":\"48\",\"3\":\"4\",\"4\":\"40\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"1\",\"4\":\"101\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"2\",\"4\":\"94\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"3\",\"4\":\"93\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"4\",\"4\":\"105\"},{\"1\":\"3\",\"2\":\"3\",\"3\":\"1\",\"4\":\"93\"},{\"1\":\"3\",\"2\":\"3\",\"3\":\"2\",\"4\":\"97\"},{\"1\":\"3\",\"2\":\"3\",\"3\":\"3\",\"4\":\"96\"},{\"1\":\"3\",\"2\":\"3\",\"3\":\"4\",\"4\":\"109\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"1\",\"4\":\"99\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"2\",\"4\":\"95\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"3\",\"4\":\"74\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"4\",\"4\":\"89\"},{\"1\":\"3\",\"2\":\"12\",\"3\":\"1\",\"4\":\"99\"},{\"1\":\"3\",\"2\":\"12\",\"3\":\"2\",\"4\":\"79\"},{\"1\":\"3\",\"2\":\"12\",\"3\":\"3\",\"4\":\"84\"},{\"1\":\"3\",\"2\":\"12\",\"3\":\"4\",\"4\":\"60\"},{\"1\":\"3\",\"2\":\"24\",\"3\":\"1\",\"4\":\"67\"},{\"1\":\"3\",\"2\":\"24\",\"3\":\"2\",\"4\":\"68\"},{\"1\":\"3\",\"2\":\"24\",\"3\":\"3\",\"4\":\"81\"},{\"1\":\"3\",\"2\":\"24\",\"3\":\"4\",\"4\":\"84\"},{\"1\":\"3\",\"2\":\"48\",\"3\":\"1\",\"4\":\"49\"},{\"1\":\"3\",\"2\":\"48\",\"3\":\"2\",\"4\":\"79\"},{\"1\":\"3\",\"2\":\"48\",\"3\":\"3\",\"4\":\"61\"},{\"1\":\"3\",\"2\":\"48\",\"3\":\"4\",\"4\":\"58\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n#análise visual dos dados em da emergencia de plantas em função dos inóculos \n\nlibrary(ggplot2)\nestande |> \nggplot(aes(trat,nplants))+\n  geom_point(color = \"gray\")+\n  geom_smooth(method = \"lm\", se = FALSE, color = \"black\")+\n    facet_wrap(~ exp)+\n  theme_minimal()+\n  labs(x= \"% de inóculo da semente\",\n       y= \"número de plantas\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n### Analise de regressão com o experimento 1\n\nGerar um modelo para cada experimento\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp1 <- estande |> \n  filter(exp == 1) |>\n  group_by(trat) |> \n  summarise(nplants2 = mean(nplants))\n\nexp1 |> \n  ggplot(aes(trat, nplants2))+\n  geom_point()+\n  ylim(20,60)\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nm_exp1 <- lm(nplants2 ~ trat, data = exp1)\nsummary(m_exp1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants2 ~ trat, data = exp1)\n\nResiduals:\n      1       2       3       4       5       6 \n 1.2500  0.7258  1.7016 -2.5968 -2.9435  1.8629 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 52.50000    1.36929  38.341 2.76e-06 ***\ntrat        -0.24194    0.06054  -3.996   0.0162 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.442 on 4 degrees of freedom\nMultiple R-squared:  0.7997,\tAdjusted R-squared:  0.7496 \nF-statistic: 15.97 on 1 and 4 DF,  p-value: 0.01618\n```\n\n\n:::\n\n```{.r .cell-code}\n# Sem summarise, mantendo 'nplants', 'trat' e 'bloco'\nexp1 <- estande |> \n  filter(exp == 1)\n\n# Modelo com trat e bloco\nm_exp1 <- lm(nplants ~ trat + bloco, data = exp1)\nsummary(m_exp1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat + bloco, data = exp1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.0769  -6.7847  -0.7817   4.0522  22.6091 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  75.5833     5.7164  13.222 1.19e-11 ***\ntrat         -0.2419     0.1323  -1.829 0.081623 .  \nbloco        -9.2333     1.9485  -4.739 0.000111 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.67 on 21 degrees of freedom\nMultiple R-squared:  0.5513,\tAdjusted R-squared:  0.5086 \nF-statistic:  12.9 on 2 and 21 DF,  p-value: 0.0002216\n```\n\n\n:::\n\n```{.r .cell-code}\nm_exp1 <- lm(nplants ~ trat + bloco, data = exp1)\nsummary(m_exp1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat + bloco, data = exp1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.0769  -6.7847  -0.7817   4.0522  22.6091 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  75.5833     5.7164  13.222 1.19e-11 ***\ntrat         -0.2419     0.1323  -1.829 0.081623 .  \nbloco        -9.2333     1.9485  -4.739 0.000111 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.67 on 21 degrees of freedom\nMultiple R-squared:  0.5513,\tAdjusted R-squared:  0.5086 \nF-statistic:  12.9 on 2 and 21 DF,  p-value: 0.0002216\n```\n\n\n:::\n\n```{.r .cell-code}\n#Na ausência de inóculo (intercepto), a média de plantas no estande é de 52. A cada aumento de 1% no inóculo, observa-se uma redução de 0,24 no número de plantas.\n```\n:::\n\n\n## Experimento 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2 <- estande |> \n  filter(exp == 2)\n\nm_exp2 <- lm(nplants ~ trat , data = exp2)\nsummary(m_exp2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n\n\n:::\n:::\n\n\n## Experimento 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp3 <- estande |> \n  filter(exp == 3)\n\nm_exp3 <- lm(nplants ~ trat , data = exp3)\nsummary(m_exp3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-26.5887  -3.9597   0.7177   5.5806  19.8952 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.53 on 22 degrees of freedom\nMultiple R-squared:  0.6085,\tAdjusted R-squared:  0.5907 \nF-statistic: 34.19 on 1 and 22 DF,  p-value: 6.968e-06\n```\n\n\n:::\n\n```{.r .cell-code}\n#calcular o slop para o experimento\nm_exp1$coefficients \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)        trat       bloco \n 75.5833333  -0.2419355  -9.2333333 \n```\n\n\n:::\n\n```{.r .cell-code}\nm_exp2$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)        trat \n 60.9857143  -0.7006912 \n```\n\n\n:::\n\n```{.r .cell-code}\nm_exp3$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)        trat \n 95.7500000  -0.7634409 \n```\n\n\n:::\n\n```{.r .cell-code}\nm_exp1$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)        trat       bloco \n 75.5833333  -0.2419355  -9.2333333 \n```\n\n\n:::\n\n```{.r .cell-code}\n(0.24 + 0.7 + 0.76)/3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5666667\n```\n\n\n:::\n:::\n\n\n## Considerando o bloco como efeito aleatório\n\n#### \\*efeito fixo é o tratamento e blocos os efeitos aleatórios.\n\n## Modelo misto\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: Matrix\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAnexando pacote: 'Matrix'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOs seguintes objetos são mascarados por 'package:tidyr':\n\n    expand, pack, unpack\n```\n\n\n:::\n\n```{.r .cell-code}\nm_misto <- lmer(nplants ~ trat + (1 | exp/bloco),\n                data = estande)\n#acima, o tratamento é efeito fixo, os experimentos e blocos efeitos aleatórios, e os blocos estão dentro dos experimentos.\n\nconfint(m_misto)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nComputing profile confidence intervals ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 2.5 %     97.5 %\n.sig01       3.3332097 14.4218422\n.sig02       7.2377419 47.8269818\n.sigma       9.7314178 13.9359486\n(Intercept) 43.4631239 96.0274587\ntrat        -0.7328972 -0.4044812\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(m_misto)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (1 | exp/bloco)\n   Data: estande\n\nREML criterion at convergence: 575.8\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.21697 -0.63351  0.04292  0.67094  1.92907 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n bloco:exp (Intercept)  54.76    7.40   \n exp       (Intercept) 377.43   19.43   \n Residual              134.99   11.62   \nNumber of obs: 72, groups:  bloco:exp, 12; exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 69.74524   11.57191   6.027\ntrat        -0.56869    0.08314  -6.840\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.111\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: carData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAnexando pacote: 'car'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nO seguinte objeto é mascarado por 'package:dplyr':\n\n    recode\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nO seguinte objeto é mascarado por 'package:purrr':\n\n    some\n```\n\n\n:::\n\n```{.r .cell-code}\nAnova(m_misto)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Chisq\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>Chisq)\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"46.78811\",\"2\":\"1\",\"3\":\"7.909164e-12\",\"_rn_\":\"trat\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\npredict(m_misto, data = estande)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in predict.merMod(m_misto, data = estande): unused arguments ignored\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       1        2        3        4        5        6        7        8 \n65.59316 64.29370 53.77994 47.28268 63.88709 62.58764 52.07388 45.57661 \n       9       10       11       12       13       14       15       16 \n62.18102 60.88157 50.36781 43.87054 58.76889 57.46943 46.95567 40.45841 \n      17       18       19       20       21       22       23       24 \n51.94462 50.64516 40.13140 33.63414 38.29608 36.99662 26.48286 19.98559 \n      25       26       27       28       29       30       31       32 \n57.58669 50.97129 63.25703 64.55649 55.88062 49.26522 61.55097 62.85042 \n      33       34       35       36       37       38       39       40 \n54.17456 47.55916 59.84490 61.14435 50.76242 44.14702 56.43276 57.73222 \n      41       42       43       44       45       46       47       48 \n43.93815 37.32275 49.60849 50.90795 30.28961 23.67421 35.95995 37.25941 \n      49       50       51       52       53       54       55       56 \n92.93706 93.40959 90.69255 92.58267 91.23100 91.70352 88.98648 90.87660 \n      57       58       59       60       61       62       63       64 \n89.52493 89.99746 87.28042 89.17053 86.11279 86.58532 83.86828 85.75840 \n      65       66       67       68       69       70       71       72 \n79.28852 79.76105 77.04401 78.93413 65.63998 66.11251 63.39547 65.28559 \n```\n\n\n:::\n\n```{.r .cell-code}\n#P foi siguinificativo\n\nestande |>\n  ggplot(aes(trat, nplants, color = factor(exp)))+\n  geom_point()+\n  #geom_smooth(method = \"lm\", se = FALSE)+\n  geom_abline(intercept = 69.74,\n              slope = -0.568, linewidth = 2)+\n  geom_abline(intercept = 43, slope = -0.73, linetype = \"dashed\")+\n  geom_abline(intercept = 96, slope = -0.40, linetype = \"dashed\")\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Regressão não linear\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfungi <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\nlibrary(dplyr)\n\n#visualizar os dados \n\nfungi |>\n  group_by(code, dose) |>\n  summarise(germination = mean(germination)) |>\n  ggplot(aes(dose, germination))+\n  geom_point()+\n  geom_line()+\n  #geom_smooth(se = FALSE)+\n  facet_wrap(~code)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'code'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nFGT43 <- fungi |>\n  group_by(code, dose) |>\n  summarise(germination = mean(germination)) |>  \nfilter(code == \"FGT43\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'code'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\n#filtrar para o conjunto de médias de FGT43\n\n#install.packages(\"drc\"), ajustar o modelo não linear aos dados \n\nlibrary(drc)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'drc' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n'drc' has been loaded.\n\nPlease cite R and 'drc' if used for a publication,\nfor references type 'citation()' and 'citation('drc')'.\n\n\nAnexando pacote: 'drc'\n\nOs seguintes objetos são mascarados por 'package:stats':\n\n    gaussian, getInitial\n```\n\n\n:::\n\n```{.r .cell-code}\nm43 <- drm(germination ~ dose,\n           data = FGT43,\n           fct = W2.3())\n  \nm43 <- drm(germination ~dose,\n           data = FGT43, \n           fct = LL.3()) #começar a testar com o modelo LL.3 \n\nsummary(m43)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  1.219692   0.175081  6.9664  0.006069 ** \nd:(Intercept) 48.486911   1.456007 33.3013 5.952e-05 ***\ne:(Intercept)  0.495895   0.060851  8.1494  0.003864 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.636105 (3 degrees of freedom)\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(m43) #quanto < o AIC, melhor. \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 26.7762\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(m43)\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nED(m43, 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50 0.495895   0.060851\n```\n\n\n:::\n\n```{.r .cell-code}\n#Estima a EC50.\n\n#testar para cada isolado, qual modelo fica melhor.\n\n#install.packages(\"ec50estimator\")\nlibrary(ec50estimator)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pacote 'ec50estimator' foi compilado no R versão 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_ec50 = estimate_EC50(germination ~ dose,\n                        data =fungi,\n                        isolate_col = \"code\",\n                        strata_col =  c(\"state\"),\n                        interval = \"delta\",\n                        fct = drc::LL.3())\nhead(df_ec50)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"state\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Estimate\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Std..Error\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Lower\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Upper\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FGT05\",\"2\":\"RS\",\"3\":\"0.04483863\",\"4\":\"0.01292307\",\"5\":\"0.01560462\",\"6\":\"0.07407264\",\"_rn_\":\"1\"},{\"1\":\"FGT06\",\"2\":\"RS\",\"3\":\"0.54497934\",\"4\":\"0.02245235\",\"5\":\"0.49418860\",\"6\":\"0.59577008\",\"_rn_\":\"2\"},{\"1\":\"FGT07\",\"2\":\"RS\",\"3\":\"0.88770190\",\"4\":\"0.08319526\",\"5\":\"0.69950114\",\"6\":\"1.07590265\",\"_rn_\":\"3\"},{\"1\":\"FGT28\",\"2\":\"RS\",\"3\":\"0.22608308\",\"4\":\"0.06652044\",\"5\":\"0.07560339\",\"6\":\"0.37656276\",\"_rn_\":\"4\"},{\"1\":\"FGT29\",\"2\":\"RS\",\"3\":\"0.23601581\",\"4\":\"0.02914746\",\"5\":\"0.17007969\",\"6\":\"0.30195194\",\"_rn_\":\"5\"},{\"1\":\"FGT33\",\"2\":\"RS\",\"3\":\"0.10481265\",\"4\":\"0.02114857\",\"5\":\"0.05697127\",\"6\":\"0.15265404\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\ndf_ec50 |>\n  ggplot(aes(reorder(ID, Estimate), Estimate))+ \n  geom_point()+\n  coord_flip()+\n  labs(y = \"EC50\",\n       x = \"Isolado\")\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\ndf_ec50 |>\n  ggplot(aes(x = Estimate))+\n  geom_histogram(bins = 5, color = \"white\")\n```\n\n::: {.cell-output-display}\n![](Aula_6_Transformações,-Modelos-Lineares-e-Curvas-Dose-Resposta_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}