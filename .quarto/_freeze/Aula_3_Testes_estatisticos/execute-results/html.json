{
  "hash": "a51de9473da6e73d9c94a9dbf317cbac",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula_3_Testes_estatisticos\"\nauthor: \"Karine Mesquita\"\nformat: \n  html:\n    code-fold: true       # permite esconder/mostrar os códigos (com uma abinha)\n    code-tools: true      # adiciona botões de copiar/mostrar código\n    toc: true             # inclui um sumário (índice)\neditor: visual\neditor_options: \n  chunk_output_type: inline\nexecute:\n  warning: false          # oculta mensagens de warning\n  message: false          # oculta mensagens do tipo \"package loaded\"\n  echo: true              # mostra o código\n  include: true           # mostra o output dos chunks\n---\n\n\n# Notas de aula\n\n# Aula 3_Testes estatisticos\n\nNesta aula, aprendemos alguns testes estatisticos basicos, dependendo do tipo de análises.\n\n## Testes para amostras independentes\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Dica: para procurar de que pacote a função vem, pesquisa na internet o nome da função, seguido de in r.\n#ativa os pacotes necessários \nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(stats)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(report)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(multcomp)\n#install_packages(\"see\")\n\n#cria o objeto com os dados que serão utilizados. Esses dados são da planilha dados-diversos, disponibilizada pelo professor. \n\ndat_mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\n#faz primeiro o plot para analizar vsualmente os dados \ndat_mg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n### Testes para saber se há diferença estatistica\n\n#### Teste T para amostras independentes\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?t.test \n#usando o caractere \"?\" seguido do nome da função, serve para mostrar como o comendo funciona, lhe dá mais informações sobre pacotes e funções. \n\n#transformar a planilha do formato longo para o formato largo  \ndat_mg2 <- dat_mg |>\n  pivot_wider(names_from = trat, values_from= comp)|>\n  dplyr::select(-rep)\n\nattach(dat_mg2)\nt.test(Mg2, control) #Teste T, que compara os tratamentos.\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  Mg2 and control\nt = -8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -6.490393 -3.825607\nsample estimates:\nmean of x mean of y \n   10.520    15.678 \n```\n\n\n:::\n\n```{.r .cell-code}\nsaída_t_teste <- t.test(Mg2, control) #cria um objeto para receber o resultado do teste T\n\n#invertendo as variáveis \nt.test(control, Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  control and Mg2\nt = 8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 3.825607 6.490393\nsample estimates:\nmean of x mean of y \n   15.678    10.520 \n```\n\n\n:::\n\n```{.r .cell-code}\nsaída_teste_T <- t.test(control, Mg2) #cria um objeto para receber o resultado do teste T\n\n#aplica a função report para gerar texto de interpretação dde saída dos resultados, neste caso para o teste T \nlibrary(report)\nreport(saída_teste_T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between control and Mg2\n(mean of x = 15.68, mean of y = 10.52) suggests that the effect is positive,\nstatistically significant, and large (difference = 5.16, 95% CI [3.83, 6.49],\nt(17.35) = 8.15, p < .001; Cohen's d = 3.65, 95% CI [2.14, 5.12])\n```\n\n\n:::\n\n```{.r .cell-code}\n#função para quando a tabela está no formato longo e não no largo, sem necessidade de transformação dos dados na tabela \nlibrary(rstatix)\nt_test(comp ~ trat, data = dat_mg)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\".y.\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"group1\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"group2\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n1\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n2\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"comp\",\"2\":\"control\",\"3\":\"Mg2\",\"4\":\"10\",\"5\":\"10\",\"6\":\"8.154907\",\"7\":\"17.35403\",\"8\":\"2.42e-07\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ntest_t <- t_test(comp ~ trat, data = dat_mg)\ntest_t\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\".y.\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"group1\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"group2\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n1\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n2\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"comp\",\"2\":\"control\",\"3\":\"Mg2\",\"4\":\"10\",\"5\":\"10\",\"6\":\"8.154907\",\"7\":\"17.35403\",\"8\":\"2.42e-07\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n#Plotando o resultado do teste T e adicionando o valor de P manualmente \n#install.packages(\"ggpubr\")\nlibrary(ggpubr)\n\np <- ggboxplot(\n  dat_mg, x = \"trat\", y = \"comp\", \n  color = \"trat\", palette = \"jco\")\n\nprint(p) #comando para mostrar o gráfico plotado, caso não apareça \n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#adiciona o valor de P manulamente \n\np + stat_pvalue_manual(test_t, label = \"p\",\n  y.position = 18)+\n    ylim(0,20)+\n  labs(x = \"Tratamento\",\n       y = \"Comprimento (mm)\")\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"plot2.png\", bg = \"white\" ) #comando para salvar o gráfico \n```\n:::\n\n\n#### Teste de normalidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#testando a normalidade dos dados acima \nshapiro.test(Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Mg2\nW = 0.97269, p-value = 0.9146\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  control\nW = 0.93886, p-value = 0.5404\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(Mg2)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(control)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# análise de variancia para validar o teste T, variancia e homogeneidade\nvar.test(dat_mg2$Mg2,\n         dat_mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  dat_mg2$Mg2 and dat_mg2$control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n```\n\n\n:::\n\n```{.r .cell-code}\n#ajuste no teste T caso as variancias não sejam homogeneas \nt.test(control, Mg2, var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  control and Mg2\nt = 8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 3.825607 6.490393\nsample estimates:\nmean of x mean of y \n   15.678    10.520 \n```\n\n\n:::\n:::\n\n\n### Teste T para amostras dependentes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nescala <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\nescala\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"assessment\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"rater\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"acuracia\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"precisao\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"vies_geral\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"vies_sistematico\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"vies_constante\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Unaided\",\"2\":\"A\",\"3\":\"0.81\",\"4\":\"0.83\",\"5\":\"0.98\",\"6\":\"1.19\",\"7\":\"0.11\"},{\"1\":\"Unaided\",\"2\":\"B\",\"3\":\"0.72\",\"4\":\"0.73\",\"5\":\"0.99\",\"6\":\"0.92\",\"7\":\"-0.11\"},{\"1\":\"Unaided\",\"2\":\"C\",\"3\":\"0.40\",\"4\":\"0.71\",\"5\":\"0.78\",\"6\":\"1.16\",\"7\":\"0.73\"},{\"1\":\"Unaided\",\"2\":\"D\",\"3\":\"0.82\",\"4\":\"0.82\",\"5\":\"1.00\",\"6\":\"0.95\",\"7\":\"-0.01\"},{\"1\":\"Unaided\",\"2\":\"E\",\"3\":\"0.75\",\"4\":\"0.75\",\"5\":\"0.99\",\"6\":\"1.10\",\"7\":\"0.07\"},{\"1\":\"Unaided\",\"2\":\"F\",\"3\":\"0.45\",\"4\":\"0.75\",\"5\":\"0.92\",\"6\":\"0.80\",\"7\":\"0.34\"},{\"1\":\"Unaided\",\"2\":\"G\",\"3\":\"0.81\",\"4\":\"0.82\",\"5\":\"0.98\",\"6\":\"1.16\",\"7\":\"0.13\"},{\"1\":\"Unaided\",\"2\":\"H\",\"3\":\"0.78\",\"4\":\"0.87\",\"5\":\"0.90\",\"6\":\"1.07\",\"7\":\"-0.47\"},{\"1\":\"Unaided\",\"2\":\"I\",\"3\":\"0.78\",\"4\":\"0.79\",\"5\":\"0.99\",\"6\":\"1.14\",\"7\":\"0.09\"},{\"1\":\"Unaided\",\"2\":\"J\",\"3\":\"0.50\",\"4\":\"0.83\",\"5\":\"0.74\",\"6\":\"0.65\",\"7\":\"-0.72\"},{\"1\":\"Aided1\",\"2\":\"A\",\"3\":\"0.91\",\"4\":\"0.95\",\"5\":\"0.96\",\"6\":\"0.89\",\"7\":\"-0.28\"},{\"1\":\"Aided1\",\"2\":\"B\",\"3\":\"0.91\",\"4\":\"0.96\",\"5\":\"0.95\",\"6\":\"0.89\",\"7\":\"-0.30\"},{\"1\":\"Aided1\",\"2\":\"C\",\"3\":\"0.91\",\"4\":\"0.96\",\"5\":\"0.95\",\"6\":\"1.28\",\"7\":\"0.21\"},{\"1\":\"Aided1\",\"2\":\"D\",\"3\":\"0.96\",\"4\":\"0.97\",\"5\":\"0.99\",\"6\":\"1.14\",\"7\":\"0.09\"},{\"1\":\"Aided1\",\"2\":\"E\",\"3\":\"0.96\",\"4\":\"0.96\",\"5\":\"1.00\",\"6\":\"1.00\",\"7\":\"-0.10\"},{\"1\":\"Aided1\",\"2\":\"F\",\"3\":\"0.90\",\"4\":\"0.97\",\"5\":\"0.93\",\"6\":\"0.86\",\"7\":\"-0.36\"},{\"1\":\"Aided1\",\"2\":\"G\",\"3\":\"0.85\",\"4\":\"0.95\",\"5\":\"0.89\",\"6\":\"0.83\",\"7\":\"-0.45\"},{\"1\":\"Aided1\",\"2\":\"H\",\"3\":\"0.88\",\"4\":\"0.97\",\"5\":\"0.90\",\"6\":\"1.29\",\"7\":\"0.38\"},{\"1\":\"Aided1\",\"2\":\"I\",\"3\":\"0.95\",\"4\":\"0.96\",\"5\":\"0.99\",\"6\":\"1.14\",\"7\":\"0.07\"},{\"1\":\"Aided1\",\"2\":\"J\",\"3\":\"0.94\",\"4\":\"0.96\",\"5\":\"0.99\",\"6\":\"0.91\",\"7\":\"-0.13\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nt_test(acuracia ~ assessment, \n       data = escala,\n       paired = TRUE,\n       var.equal = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\".y.\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"group1\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"group2\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n1\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n2\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"acuracia\",\"2\":\"Aided1\",\"3\":\"Unaided\",\"4\":\"10\",\"5\":\"10\",\"6\":\"4.421388\",\"7\":\"9\",\"8\":\"0.00167\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nt_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nfunction (data, formula, comparisons = NULL, ref.group = NULL, \n    p.adjust.method = \"holm\", paired = FALSE, var.equal = FALSE, \n    alternative = \"two.sided\", mu = 0, conf.level = 0.95, detailed = FALSE) \n{\n    env <- as.list(environment())\n    args <- env %>% .add_item(method = \"t_test\")\n    params <- env %>% remove_null_items() %>% add_item(method = \"t.test\")\n    outcome <- get_formula_left_hand_side(formula)\n    group <- get_formula_right_hand_side(formula)\n    number.of.groups <- guess_number_of_groups(data, group)\n    if (number.of.groups > 2 & !is.null(ref.group)) {\n        if (ref.group %in% c(\"all\", \".all.\")) {\n            params$data <- create_data_with_all_ref_group(data, \n                outcome, group)\n            params$ref.group <- \"all\"\n        }\n    }\n    test.func <- two_sample_test\n    if (number.of.groups > 2) \n        test.func <- pairwise_two_sample_test\n    do.call(test.func, params) %>% set_attrs(args = args) %>% \n        add_class(c(\"rstatix_test\", \"t_test\"))\n}\n<bytecode: 0x000001f67e971bd8>\n<environment: namespace:rstatix>\n```\n\n\n:::\n\n```{.r .cell-code}\n#plotando o gráfico para análise visual\nlibrary(ggplot2)\n\nescala |> \n  ggplot(aes(assessment, acuracia))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nunaided <- escala |> \n  dplyr::filter(assessment == \"Unaided\") |> \n  dplyr::select(acuracia) |> \n  dplyr::pull()\n\nunaided \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.81 0.72 0.40 0.82 0.75 0.45 0.81 0.78 0.78 0.50\n```\n\n\n:::\n\n```{.r .cell-code}\naided <- escala |> \n  dplyr::filter(assessment == \"Aided1\") |> \n  dplyr::select(acuracia) |> \n  dplyr::pull() \n\naided\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.91 0.91 0.91 0.96 0.96 0.90 0.85 0.88 0.95 0.94\n```\n\n\n:::\n\n```{.r .cell-code}\n#faz um teste de variancia \n  var.test(unaided, aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  unaided and aided\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n```\n\n\n:::\n\n```{.r .cell-code}\n  hist(unaided)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\n  hist(aided)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n```{.r .cell-code}\n  shapiro.test(unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  unaided\nW = 0.7748, p-value = 0.007155\n```\n\n\n:::\n\n```{.r .cell-code}\n  shapiro.test(aided) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  aided\nW = 0.92852, p-value = 0.4335\n```\n\n\n:::\n\n```{.r .cell-code}\n  #como a variancia foi heterogenea, faz o seguinte ajuste no teste\n  t.test(unaided, aided, paired = TRUE, \n         var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  unaided and aided\nt = -4.4214, df = 9, p-value = 0.001668\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -0.3552353 -0.1147647\nsample estimates:\nmean difference \n         -0.235 \n```\n\n\n:::\n\n```{.r .cell-code}\n  #teste de Wilcoxon se apresenta como uma alterativa ao teste t pareado, ou seja, quando o objetivo também é verificar se existe diferença significativa de uma variável numérica entre dois grupos de interesse.\n  wilcox.test(unaided, aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  unaided and aided\nW = 0, p-value = 0.0001756\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n```{.r .cell-code}\n  #teste equivalente Mann-Whitney é o teste não paramétrico equivalente ao teste t para amostras independentes\n  wilcox.test(unaided, aided, paired = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  unaided and aided\nW = 0, p-value = 0.0001756\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n```{.r .cell-code}\n  #paired = false o transforma num mann-whitney \n```\n:::\n\n\n### Testes para 3 ou mais niveis de fator (3 ou mais tratamentos)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  micelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n  \n  #Análise visual \n  \n  micelial |> \n    ggplot(aes(especie, tcm))+\n    geom_boxplot(outlier.colour = NA)+\n    geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  #Anova \n  anova1 <- aov(tcm ~ especie, data = micelial)\n  anova1 \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = tcm ~ especie, data = micelial)\n\nTerms:\n                  especie Residuals\nSum of Squares  1.4695800 0.4679167\nDeg. of Freedom         4        25\n\nResidual standard error: 0.1368089\nEstimated effects may be unbalanced\n```\n\n\n:::\n\n```{.r .cell-code}\n  anova(anova1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4\",\"2\":\"1.4695800\",\"3\":\"0.36739500\",\"4\":\"19.6293\",\"5\":\"2.027704e-07\",\"_rn_\":\"especie\"},{\"1\":\"25\",\"2\":\"0.4679167\",\"3\":\"0.01871667\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n  #outra forma de fazer a ANOVA\n  anova2 <- lm(tcm ~ especie, data = micelial)\n    anova(anova2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4\",\"2\":\"1.4695800\",\"3\":\"0.36739500\",\"4\":\"19.6293\",\"5\":\"2.027704e-07\",\"_rn_\":\"especie\"},{\"1\":\"25\",\"2\":\"0.4679167\",\"3\":\"0.01871667\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n    #residuo é a diferença entre o estimado pelo modelo e o observado \n    #será que os resíduos são normais? \n    residuals(anova1) #resíduos da anova\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          1           2           3           4           5           6 \n-0.07166667  0.01833333 -0.05166667 -0.05166667  0.02833333  0.12833333 \n          7           8           9          10          11          12 \n 0.28333333  0.01333333  0.03333333  0.06333333 -0.15666667 -0.23666667 \n         13          14          15          16          17          18 \n-0.10166667 -0.08166667 -0.12166667  0.06833333  0.10833333  0.12833333 \n         19          20          21          22          23          24 \n-0.03166667  0.06833333 -0.20166667  0.08833333 -0.01166667  0.08833333 \n         25          26          27          28          29          30 \n 0.12333333  0.19333333  0.14333333 -0.11666667 -0.14666667 -0.19666667 \n```\n\n\n:::\n\n```{.r .cell-code}\nhist(residuals(anova1))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(residuals(anova1)) #testa a normalidade dos resíduos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(anova1)\nW = 0.9821, p-value = 0.8782\n```\n\n\n:::\n\n```{.r .cell-code}\n    #teste para variancias de modelo \n\n    #teste bartlett testa se as variancias são homogeneas\n\n    bartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n\n\n:::\n\n```{.r .cell-code}\n    #teste de levene tem o mesmo propósito (menos sensível a desvios de normalidade\n    levene_test(tcm ~especie, data = micelial)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"df1\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"df2\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4\",\"2\":\"25\",\"3\":\"1.756309\",\"4\":\"0.1693198\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n  #Use Levene quando os dados não forem normalmente distribuídos.\n#Use Bartlett quando os dados forem normalmente distribuídos.\n#Se ambos os testes indicarem que as variâncias são iguais, você pode seguir com a ANOVA.\n    \n  library(emmeans)\n    #pacote para calcular as médias do modelo e intervalo de confiança. Realiza contrastes e estimativas de médias após a modelagem estatística\n      m <- emmeans(anova2, ~ especie)\n  m \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n  #emmeans nos deu a média por espécies, então usa o multicomp para comparar e visualizar as diferenças entre elas  \n  #install.packages(\"multcomp\")\n  #install.packages(\"multcompView\")\n  library(multcomp)\n  library(multcompView)\n  #o pacote multcom realiza comparações múltiplas (post hoc) após modelos lineares, modelos lineares generalizados, e outros tipos de modelos\n  \n  cld(m) #mostra letras compactas, ou seja, os grupos. Nesse caso, do emmeans\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"especie\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"emmean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lower.CL\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"upper.CL\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\".group\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Fgra\",\"2\":\"0.9116667\",\"3\":\"0.05585199\",\"4\":\"25\",\"5\":\"0.7966373\",\"6\":\"1.026696\",\"7\":\"1\",\"_rn_\":\"4\"},{\"1\":\"Faus\",\"2\":\"1.2366667\",\"3\":\"0.05585199\",\"4\":\"25\",\"5\":\"1.1216373\",\"6\":\"1.351696\",\"7\":\"2\",\"_rn_\":\"2\"},{\"1\":\"Fcor\",\"2\":\"1.3216667\",\"3\":\"0.05585199\",\"4\":\"25\",\"5\":\"1.2066373\",\"6\":\"1.436696\",\"7\":\"2\",\"_rn_\":\"3\"},{\"1\":\"Fmer\",\"2\":\"1.4266667\",\"3\":\"0.05585199\",\"4\":\"25\",\"5\":\"1.3116373\",\"6\":\"1.541696\",\"7\":\"23\",\"_rn_\":\"5\"},{\"1\":\"Fasi\",\"2\":\"1.5716667\",\"3\":\"0.05585199\",\"4\":\"25\",\"5\":\"1.4566373\",\"6\":\"1.686696\",\"7\":\"3\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n pwpm(m) #mostra as médias na diagonal e compara entre os tratamentos em forma de matriz \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Fasi    Faus    Fcor    Fgra    Fmer\nFasi [1.572]  0.0023  0.0302  <.0001  0.3765\nFaus   0.335 [1.237]  0.8169  0.0031  0.1469\nFcor   0.250  -0.085 [1.322]  0.0002  0.6761\nFgra   0.660   0.325   0.410 [0.912]  <.0001\nFmer   0.145  -0.190  -0.105  -0.515 [1.427]\n\nRow and column labels: especie\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\n pairs(m) #mostra as médias em lista e compara, igual o anterior, mas com formas de saída diferentes. Mostra os resultados pareados\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast    estimate    SE df t.ratio p.value\n Fasi - Faus    0.335 0.079 25   4.241  0.0023\n Fasi - Fcor    0.250 0.079 25   3.165  0.0302\n Fasi - Fgra    0.660 0.079 25   8.356  <.0001\n Fasi - Fmer    0.145 0.079 25   1.836  0.3765\n Faus - Fcor   -0.085 0.079 25  -1.076  0.8169\n Faus - Fgra    0.325 0.079 25   4.115  0.0031\n Faus - Fmer   -0.190 0.079 25  -2.405  0.1469\n Fcor - Fgra    0.410 0.079 25   5.191  0.0002\n Fcor - Fmer   -0.105 0.079 25  -1.329  0.6761\n Fgra - Fmer   -0.515 0.079 25  -6.520  <.0001\n\nP value adjustment: tukey method for comparing a family of 5 estimates \n```\n\n\n:::\n\n```{.r .cell-code}\n#no caso acima a  normalidade estava ok e as variancias eram nos resíduos \n```\n:::\n\n\n### Quando os dados não seguem distribuição normal...\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#aqui utilizamos um banco de dados do proprio R. \n\ninsetos <- InsectSprays\nView(insetos) #comando para visualizar o conjunto de dados\n\n insetos |> \n   ggplot(aes(spray, count))+\n   geom_boxplot(outlier.colour = NA)+\n   geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n #modelo de anova para inspecionar normalidade e variancia \n anova3 <- lm(count ~spray, data = insetos)\n   anova(anova3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5\",\"2\":\"2668.833\",\"3\":\"533.76667\",\"4\":\"34.70228\",\"5\":\"3.182584e-17\",\"_rn_\":\"spray\"},{\"1\":\"66\",\"2\":\"1015.167\",\"3\":\"15.38131\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n   #teste para variaveis homogeneas \n   bartlett.test(count ~spray, data = insetos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n\n\n:::\n\n```{.r .cell-code}\n   #sempre que a variancia for heterogenea tem que ajustar \n   \n  #Ajusta um modelo linear (lm) para verificar se o tipo de spray tem efeito no número de insetos mortos (count) \n   \n   m2 <- lm(count ~spray, data = insetos)\n   hist(residuals (m2))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\n   shapiro.test(residuals(m2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m2)\nW = 0.96006, p-value = 0.02226\n```\n\n\n:::\n\n```{.r .cell-code}\n   #neste caso não é distribuição normal e nem homogenea \n   \n   #verificar visualmente se os resíduos do modelo m2 seguem uma distribuição normal\n   qqnorm(residuals(m2))\n   qqline(residuals(m2))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\n   #quando chamar qqnorm e qqline juntos a linha e os pontos tem que estar juntos, para ser de fato normal, indicar normalidade.  \n```\n:::\n\n\n### Alternativas quando os dados não seguirem normalidade e homogenedade\n\nTem 3 alternativas para os casos em que isso ocorra, dados não normais e heterogeneos (em ANOVA)\n\n#### Alternativa 1: transformação de dados, transformar a resposta\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   #primeiro testa função log\n   m3 <- lm(log(count + 0.1) ~spray, data = insetos)\n   hist(residuals (m3))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n   shapiro.test(residuals(m3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m3)\nW = 0.8663, p-value = 1.736e-06\n```\n\n\n:::\n\n```{.r .cell-code}\n   qqnorm(residuals(m3))\n     qqline(residuals(m3))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\n   #continuou com o erro, agora testa raiz quadrada \n   \n   #REGRA: neste caso a raiz é uma boa saída pois quando são dados de contagem numa distribuição de poisson não normal, a raiz quadrada tende a normalizar a contagem individual. \n  #aplica o modelo raiz quadrada e aplica a Anova parametrica normal \n  \n   m4 <- lm(sqrt(count) ~ spray, data = insetos)\n   hist(residuals (m4))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\n   shapiro.test(residuals(m4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m4)\nW = 0.98721, p-value = 0.6814\n```\n\n\n:::\n\n```{.r .cell-code}\n   qqnorm(residuals(m4))\n   qqline(residuals(m4))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n\n```{.r .cell-code}\n   #testar se as variâncias são homogêneas\n   bartlett.test(sqrt(count) ~spray, data = insetos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  sqrt(count) by spray\nBartlett's K-squared = 3.7525, df = 5, p-value = 0.5856\n```\n\n\n:::\n\n```{.r .cell-code}\n   anova(m4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5\",\"2\":\"88.43787\",\"3\":\"17.6875745\",\"4\":\"44.79933\",\"5\":\"6.334505e-20\",\"_rn_\":\"spray\"},{\"1\":\"66\",\"2\":\"26.05798\",\"3\":\"0.3948178\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n   report(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWe fitted a linear model (estimated using OLS) to predict count with spray\n(formula: sqrt(count) ~ spray). The model explains a statistically significant\nand substantial proportion of variance (R2 = 0.77, F(5, 66) = 44.80, p < .001,\nadj. R2 = 0.76). The model's intercept, corresponding to spray = A, is at 3.76\n(95% CI [3.40, 4.12], t(66) = 20.73, p < .001). Within this model:\n\n  - The effect of spray [B] is statistically non-significant and positive (beta =\n0.12, 95% CI [-0.40, 0.63], t(66) = 0.45, p = 0.653; Std. beta = 0.04, 95% CI\n[-0.15, 0.23])\n  - The effect of spray [C] is statistically significant and negative (beta =\n-2.52, 95% CI [-3.03, -2.00], t(66) = -9.81, p < .001; Std. beta = -0.94, 95%\nCI [-1.13, -0.75])\n  - The effect of spray [D] is statistically significant and negative (beta =\n-1.60, 95% CI [-2.11, -1.08], t(66) = -6.22, p < .001; Std. beta = -0.59, 95%\nCI [-0.79, -0.40])\n  - The effect of spray [E] is statistically significant and negative (beta =\n-1.95, 95% CI [-2.46, -1.44], t(66) = -7.61, p < .001; Std. beta = -0.73, 95%\nCI [-0.92, -0.54])\n  - The effect of spray [F] is statistically non-significant and positive (beta =\n0.26, 95% CI [-0.25, 0.77], t(66) = 1.01, p = 0.318; Std. beta = 0.10, 95% CI\n[-0.09, 0.29])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n\n\n:::\n\n```{.r .cell-code}\n   m44 <- emmeans(m4, ~spray, type = \"response\")\n   cld(m44)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"spray\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"response\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lower.CL\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"upper.CL\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\".group\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"C\",\"2\":\"1.549668\",\"3\":\"0.4516033\",\"4\":\"66\",\"5\":\"0.7791672\",\"6\":\"2.582477\",\"7\":\"1\",\"_rn_\":\"3\"},{\"1\":\"E\",\"2\":\"3.274149\",\"3\":\"0.6564278\",\"4\":\"66\",\"5\":\"2.0947029\",\"6\":\"4.715904\",\"7\":\"12\",\"_rn_\":\"5\"},{\"1\":\"D\",\"2\":\"4.684428\",\"3\":\"0.7851742\",\"4\":\"66\",\"5\":\"3.2479310\",\"6\":\"6.383233\",\"7\":\"2\",\"_rn_\":\"4\"},{\"1\":\"A\",\"2\":\"14.142702\",\"3\":\"1.3642814\",\"4\":\"66\",\"5\":\"11.5499805\",\"6\":\"16.997732\",\"7\":\"3\",\"_rn_\":\"1\"},{\"1\":\"B\",\"2\":\"15.028271\",\"3\":\"1.4063463\",\"4\":\"66\",\"5\":\"12.3515643\",\"6\":\"17.967286\",\"7\":\"3\",\"_rn_\":\"2\"},{\"1\":\"F\",\"2\":\"16.149284\",\"3\":\"1.4578552\",\"4\":\"66\",\"5\":\"13.3697363\",\"6\":\"19.191140\",\"7\":\"3\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n   plot(m44)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-7-5.png){width=672}\n:::\n:::\n\n\n#### Alternativa 2: teste não parametrico equivalente a anova\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#ou seja ele não depende das duas premissas de normalidade e homogeneidade, ele faz um ranqueamento, tipo o wilcox\n\n   #O teste de Kruskal-Wallis é um método estatístico não paramétrico que compara se três ou mais grupos têm a mesma distribuição. \n\n   #mas este teste só diz que pelo menos um é diferente, mas não aponta quais são. \n   \n   kruskal.test(count ~ spray, data = insetos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n\n\n:::\n\n```{.r .cell-code}\n   kruskal_test(insetos, count ~ spray)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\".y.\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"p\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"count\",\"2\":\"72\",\"3\":\"54.69134\",\"4\":\"5\",\"5\":\"1.51e-10\",\"6\":\"Kruskal-Wallis\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n   #Para realizar o teste de Kruskal-Wallis e fazer comparações múltiplas pós-hoc entre os grupos, semelhante ao Tukey, mas para dados não paramétricos.\n   \n   library(agricolae) \n   kruskal.test(insetos$count, insetos$spray, group = TRUE, console = TRUE) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  insetos$count and insetos$spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n\n\n:::\n\n```{.r .cell-code}\n   #Mostra o p valor e a diferença entre as médias. O \"group = true\" exibe as letras dos agrupamentos, enquanto \"console = true\" apresenta os resultados no console\n   \n   #como foi significante, transforma para rank para fazer o não parametrico. \n   \n  m5 <- lm(rank(count) ~spray, data = insetos)\n  m5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = rank(count) ~ spray, data = insetos)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n     52.167        2.667      -40.708      -26.583      -32.833        3.458  \n```\n\n\n:::\n\n```{.r .cell-code}\n   hist(residuals (m5))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n   shapiro.test(residuals(m5))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m5)\nW = 0.98287, p-value = 0.4342\n```\n\n\n:::\n\n```{.r .cell-code}\n   qqnorm(residuals(m5))\n   qqline(residuals(m5))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\n   #quando partir para a alternativa a anova parametrica? ou seja, quando não possui normalidade nem homogeneidade dos dados.(usando shapiro-wilk, que testa normalidade dos residuos, e o bartlett ou levene que testam a homogeneidade)\n   \n   #essas comparações multiplas são post-hoc, as duas primeiras opções, mas quando não dá siguinificativo não faz post hoc, pois não tem diferença entre grupos \n  \n    #quando não tem via de transformação, nada resolveu o problema de normalidade e homocedasticidade, tem que usar não parametrico mesmo!\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n    #utilizando o pacote DHARMa \n#install.packages(\"DHARMa\")\nlibrary(DHARMa)\n\n   #faz uma simulação dos residuos, não pega somente  observação \n   #o DHARMa é mais intuitivo, ao invés de usar Levene, hist, qqnorm, shapiro..., pode usar o teste DHARMa como padrão. Para ver visualmente todas estas estatisticas em uma única função, por meio da simulação dos resíduos. Dando siguinificativo, vai para os testes post hoc\n   \nlibrary(emmeans)\nlibrary(tidyverse)\n\ninsetos <- InsectSprays\nView(insetos)\nm2 <- lm(count ~ spray, data = insetos) #variâncias não são homogêneas\nplot(simulateResiduals(m2))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nm2 <- lm(log(count+1) ~ spray, data = insetos) #transformar os dados para tornar as variâncias homogêneas\nplot(simulateResiduals(m2))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\n    library(emmeans) #para estimar as médias\nlibrary(multcomp)\nm2.2 <- emmeans(m2, ~ spray, type = \"response\")\ncld(m2.2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"spray\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"response\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lower.CL\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"upper.CL\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\".group\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"C\",\"2\":\"1.592459\",\"3\":\"0.3062359\",\"4\":\"66\",\"5\":\"1.047790\",\"6\":\"2.281998\",\"7\":\"1\",\"_rn_\":\"3\"},{\"1\":\"E\",\"2\":\"3.163010\",\"3\":\"0.4917584\",\"4\":\"66\",\"5\":\"2.288373\",\"6\":\"4.270282\",\"7\":\"12\",\"_rn_\":\"5\"},{\"1\":\"D\",\"2\":\"4.547299\",\"3\":\"0.6552784\",\"4\":\"66\",\"5\":\"3.381826\",\"6\":\"6.022762\",\"7\":\"2\",\"_rn_\":\"4\"},{\"1\":\"A\",\"2\":\"13.831278\",\"3\":\"1.7519545\",\"4\":\"66\",\"5\":\"10.715267\",\"6\":\"17.776082\",\"7\":\"3\",\"_rn_\":\"1\"},{\"1\":\"B\",\"2\":\"14.745307\",\"3\":\"1.8599248\",\"4\":\"66\",\"5\":\"11.437261\",\"6\":\"18.933223\",\"7\":\"3\",\"_rn_\":\"2\"},{\"1\":\"F\",\"2\":\"15.704220\",\"3\":\"1.9731970\",\"4\":\"66\",\"5\":\"12.194708\",\"6\":\"20.147186\",\"7\":\"3\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n#### Alternativa 3: alternativa paramétrica - Modelos lineares generalizados (GLMs)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   #nas ANOVAs, possuem um tipos especial de modelo linear generalizado, onde a distribuição é normal, Gaussiana, existem familias de dirtrubuição. \n   #no caso de dados de contagem, como de insetos, usa de Poisson, neste caso não galsiana. \n   \n      m2.3 <- glm(count ~ spray, data = insetos, \n             family = poisson)\n      \n         m2.3 \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:  glm(formula = count ~ spray, family = poisson, data = insetos)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n    2.67415      0.05588     -1.94018     -1.08152     -1.42139      0.13926  \n\nDegrees of Freedom: 71 Total (i.e. Null);  66 Residual\nNull Deviance:\t    409 \nResidual Deviance: 98.33 \tAIC: 376.6\n```\n\n\n:::\n\n```{.r .cell-code}\n         anova(m2.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Deviance\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Df\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Dev\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>Chi)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"NA\",\"2\":\"NA\",\"3\":\"71\",\"4\":\"409.04119\",\"5\":\"NA\",\"_rn_\":\"NULL\"},{\"1\":\"5\",\"2\":\"310.7125\",\"3\":\"66\",\"4\":\"98.32866\",\"5\":\"4.979375e-65\",\"_rn_\":\"spray\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n          plot(simulateResiduals(m2.3))\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n         library(car)\n         Anova(m2.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"LR Chisq\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>Chisq)\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"310.7125\",\"2\":\"5\",\"3\":\"4.979375e-65\",\"_rn_\":\"spray\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n         medias_m2.3 <- emmeans(m2.3, ~ spray, type = \"response\")\n         medias_m2.3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n spray  rate    SE  df asymp.LCL asymp.UCL\n A     14.50 1.100 Inf     12.50     16.82\n B     15.33 1.130 Inf     13.27     17.72\n C      2.08 0.417 Inf      1.41      3.08\n D      4.92 0.640 Inf      3.81      6.35\n E      3.50 0.540 Inf      2.59      4.74\n F     16.67 1.180 Inf     14.51     19.14\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n```\n\n\n:::\n\n```{.r .cell-code}\n         cld(medias_m2.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"spray\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"rate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"asymp.LCL\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"asymp.UCL\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\".group\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"C\",\"2\":\"2.083333\",\"3\":\"0.4166664\",\"4\":\"Inf\",\"5\":\"1.407727\",\"6\":\"3.083181\",\"7\":\"1\",\"_rn_\":\"3\"},{\"1\":\"E\",\"2\":\"3.500000\",\"3\":\"0.5400617\",\"4\":\"Inf\",\"5\":\"2.586573\",\"6\":\"4.735996\",\"7\":\"12\",\"_rn_\":\"5\"},{\"1\":\"D\",\"2\":\"4.916667\",\"3\":\"0.6400955\",\"4\":\"Inf\",\"5\":\"3.809375\",\"6\":\"6.345820\",\"7\":\"2\",\"_rn_\":\"4\"},{\"1\":\"A\",\"2\":\"14.500000\",\"3\":\"1.0992422\",\"4\":\"Inf\",\"5\":\"12.497944\",\"6\":\"16.822767\",\"7\":\"3\",\"_rn_\":\"1\"},{\"1\":\"B\",\"2\":\"15.333333\",\"3\":\"1.1303883\",\"4\":\"Inf\",\"5\":\"13.270435\",\"6\":\"17.716910\",\"7\":\"3\",\"_rn_\":\"2\"},{\"1\":\"F\",\"2\":\"16.666667\",\"3\":\"1.1785113\",\"4\":\"Inf\",\"5\":\"14.509743\",\"6\":\"19.144225\",\"7\":\"3\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n    #outra forma de testar o modelo \n         #install.packages(\"performance\") \n         library(performance)\n        performance(m2.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"AIC\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AICc\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BIC\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"R2_Nagelkerke\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RMSE\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sigma\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Score_log\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Score_spherical\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"376.5892\",\"2\":\"377.8815\",\"3\":\"390.2492\",\"4\":\"0.9900152\",\"5\":\"3.754935\",\"6\":\"1\",\"7\":\"-2.53187\",\"8\":\"0.09843287\",\"_rn_\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n        check_model(m2.3)\n```\n\n::: {.cell-output-display}\n![](Aula_3_Testes_estatisticos_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\n        #dados de sim e não, usa a familia binomial \n        #o professor recomenda usar o DHARMa ao invés do check model, ele não é tão consistente  \n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}